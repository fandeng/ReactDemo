import React, { Component } from 'react';
import {
    StyleSheet,
    Text,
    Image,
    ListView,
    ScrollView,
    TouchableOpacity,
    View,
    InteractionManager,
    Dimensions,
    Platform,
    ActionSheetIOS,
    Linking
} from 'react-native';

import Common from '../common/common';
import HeaderView from '../common/HeaderView';

import DeviceInfo from 'react-native-device-info';

import MySetting from '../pages/MySetting';
import MineLoanContainer from '../pages/MyLoan';
import MyDataDetial from '../pages/MyDataDetial';

// import MyDataDetial from '../components/Picker';

import ResponseData from '../Data/Response.json';
import REQUEST_JSON from '../Data/Request.json';

var DataRepository = require('../Data/DataRepository');
var repository = new DataRepository();

class MineContainer extends Component {
    constructor(props) {
        super(props);
        this.state = {
          data:ResponseData.queryuserinfo.response_body
        };
    }
    render() {
      this.request();
        return (
          <View style = {{backgroundColor: '#f0f1f2'}}>
            <ScrollView style = {{width:Common.window.width,height:Common.window.height-49}}>
               <Image style = {styles.TopView_back} source = {require("../img/minebg.png")}>
                    <View style = {styles.TopImage_back}>
                      <Image style = {styles.TopImage} source = {{uri:this.state.data.headurl}}/>
                      <TouchableOpacity
                          activeOpacity={0.5}
                          onPress={()=>this._onCallCustomer()}
                          style={styles.center}>
                          <View style = {styles.TopCustomer_back}>
                            <Image style = {styles.Customer_Image} source = {require("../img/customer.png")}></Image>
                            <Text style = {styles.Customer_text}>客服</Text>
                          </View>
                      </TouchableOpacity>
                    </View>
                    <Text style = {styles.TopPhone_text}>{this.state.data.servnum}</Text>
                    <Text style = {styles.TopName_text}>{this.state.data.name}</Text>
                    <View style = {styles.TopView_bottom}>
                        <View style={[styles.TopBottom_child,{marginLeft:10}]}>
                          <Text style={styles.TopBottom_text}>申请贷款(笔)</Text>
                          <Text style={styles.TopBottom_text}>{this.state.data.loan_num}</Text>
                        </View>
                        <View style={{backgroundColor:'rgba(255.0, 255.0, 255.0, 0.5)',width:1,height:60}}/>
                        <View style={styles.TopBottom_child}>
                          <Text style={styles.TopBottom_text}>需还贷款(笔)</Text>
                          <Text style={styles.TopBottom_text}>{this.state.data.repay_num}</Text>
                        </View>
                    </View>
               </Image>
               <TouchableOpacity
                   activeOpacity={0.5}
                   onPress={()=>this._onPressFeedItem('first',MineLoanContainer)}
                   style={styles.center}>
                   <View style = {styles.Rowcontainer}>
                      <Image style = {styles.RowImage_left} source = {require("../img/essay.png")}></Image>
                      <Text style = {styles.RowTitle_text}>我的贷款</Text>
                      <Image style = {styles.RowImage_right} source = {require("../img/listPromte.png")}></Image>
                   </View>
               </TouchableOpacity>
               <TouchableOpacity
                   activeOpacity={0.5}
                   onPress={()=>this._onPressFeedItem('second',MyDataDetial)}
                   style={styles.center}>
                   <View style = {styles.Rowcontainer}>
                      <Image style = {{width:20,height:16,marginLeft: 10}} source = {require("../img/mine.png")}></Image>
                      <Text style = {styles.RowTitle_text}>我的资料</Text>
                      <Image style = {styles.RowImage_right} source = {require("../img/listPromte.png")}></Image>
                   </View>
               </TouchableOpacity>
               <View style= {{height:15}}/>
               <TouchableOpacity
                   activeOpacity={0.5}
                   onPress={()=>this._onPressFeedItem('third',MySetting)}
                   style={styles.center}>
                   <View style = {styles.Rowcontainer}>
                      <Image style = {styles.RowImage_left} source = {require("../img/setting.png")}></Image>
                      <Text style = {styles.RowTitle_text}>设置</Text>
                      <Image style = {styles.RowImage_right} source = {require("../img/listPromte.png")}></Image>
                   </View>
               </TouchableOpacity>
            </ScrollView>
          </View>
        );
    }
    //item点击事件
    _onPressFeedItem(aSceneName,aIndexNumber) {
        InteractionManager.runAfterInteractions(() => {
            this.props.navigator.push({
                name: aSceneName,
                component: aIndexNumber,
            })
        });
    }
    //客服事件
    _onCallCustomer(){
      Linking.canOpenURL('tel:18352402477').then(supported => {
         if (supported) {
            if (Platform.OS === 'ios') {
                ActionSheetIOS.showActionSheetWithOptions({
                  options: ['18352402477', '取消'],
                  cancelButtonIndex: 1,
                  tintColor: '#1e90ff',
                },
                (buttonIndex) => {
                  buttonIndex == 0?Linking.openURL('tel:18352402477'):console.log('取消');
                });
            } else {
               Linking.openURL('tel:18352402477');
            }
         }
      })
    }
    request() {
        var queryuserinfo = REQUEST_JSON.queryuserinfo;
        queryuserinfo.userid = '123';
        repository.launchRequest('queryuserinfo',queryuserinfo).then((responseData) => {
          console.log(responseData.response_body);
        }).done();
    }

}

const styles = StyleSheet.create({
    center:{
        flexDirection: 'row',
        justifyContent: 'center',
        alignItems: 'center',
    },
    Rowcontainer: {
      width: Common.window.width,
      height:55,
      flexDirection: 'row',
      alignItems: 'center',
      backgroundColor: 'white',
      borderBottomColor: 'rgba(230.0, 230.0, 230.0, 1.0)',
      borderBottomWidth: 1,
    },
    RowImage_right: {
     height: 15,
     width: 8,
     marginRight: 10,
    },
    RowImage_left: {
      height: 20,
      width: 20,
      marginLeft: 10,
    },
    RowTitle_text: {
     textAlign: 'left',
     fontSize: 15,
     color: '#333333',
     marginLeft:10,
     width:Common.window.width-70,
    },
    TopView_back:{
      // backgroundColor: '#1a98ff',
      height: Platform.OS == 'ios'?260:240,
      width: Common.window.width,
    },
    TopImage:{
      height: 60,
      width: 60,
      marginTop: 0,
      marginLeft: Common.window.width/2-30,
      borderRadius:30,
      borderColor:'white',
      borderWidth:2,
    },
    TopPhone_text:{
      backgroundColor:'rgba(22.0, 114.0, 226.0, 0.0)',
      textAlign: 'center',
      fontSize: 14,
      color: 'white',
      marginTop:10,
      marginLeft:20,
      width:Common.window.width-40,
      height:20,
    },
    TopName_text:{
      backgroundColor:'rgba(22.0, 114.0, 226.0, 0.0)',
      textAlign: 'center',
      fontSize: 14,
      color: 'white',
      marginTop:10,
      marginLeft:20,
      height:20,
      width:Common.window.width-40,
    },
    TopView_bottom:{
      marginTop:Platform.OS == 'ios'?10:10,
      height:Platform.OS == 'ios'?90:90,
      flexDirection: 'row',
      alignItems: 'center'
    },
    TopBottom_child:{
      width:(Common.window.width-20)/2,
      height:70,
      alignItems: 'center'
    },
    TopBottom_text:{
      backgroundColor:'rgba(22.0, 114.0, 226.0, 0.0)',
      color:'white',
      fontSize: 14,
      marginTop:10,
      textAlign:'center',
      width:(Common.window.width-20)/2,
    },
    TopImage_back:{
     height: 60,
     width: Common.window.width,
     marginTop: Platform.OS == 'ios'?40:20,
     flexDirection: 'row'
    },
    TopCustomer_back:{
     backgroundColor:'rgba(22.0, 114.0, 226.0, 0.0)',
     alignItems: 'flex-start',
     height: 60,
     width: 40,
     marginTop: 0,
     marginRight:10,
     marginLeft:Common.window.width/4
   },
    Customer_Image:{
     marginLeft:10,
     width:20,
     height:20
   },
    Customer_text:{
     backgroundColor:'rgba(22.0, 114.0, 226.0, 0.0)',
     textAlign: 'center',
     fontSize: 14,
     color: 'white',
     width:40,
     marginTop:5,
   }
});
module.exports = MineContainer;
