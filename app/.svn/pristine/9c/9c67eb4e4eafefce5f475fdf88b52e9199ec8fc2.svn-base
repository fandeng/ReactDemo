//添加银行卡界面
//'use strict'
import React, { Component } from 'react';
import {
    StyleSheet,
    Text,
    TextInput,
    ScrollView,
    ListView,
    View,
    Dimensions,
    Platform,
    TouchableOpacity,
    InteractionManager,
    Image,
    Alert,
} from 'react-native';

import Common from '../common/common';
import HeaderView from '../common/HeaderView';

import InformationProgressContainer from '../components/InformationProgress'

import ResponseData from '../Data/Response.json';
import REQUEST_JSON from '../Data/Request.json';
var DataRepository = require('../Data/DataRepository');
var repository = new DataRepository();
import { toastShort } from '../utils/ToastUtil';

let bankname;
let bankcard;
class AddBankCardContainer extends Component {
    constructor(props) {
  	  super(props);
  	  this.state = {
  	  	info:this.props.info,
  	  };
  	}
    render() {
        return (
          <View>
            <HeaderView  titleView= {'添加银行卡'}
              leftIcon={'angle-left'}
              leftIconAction={() => this.props.navigator.pop() }
              rightButton={'完成'}
              collectIconAction={() => this.onPressHandler() }/>
              <ScrollView style={{backgroundColor:'#f0f1f2', height: Common.window.height-64,width:Common.window.width}}>
                  <InformationProgressContainer numSign = {1}  image = {['1','1','1','1','0']} progressArray={['个人信息',"单位信息",' 拍照认证','紧急联系人','添加银行卡']}/>
                  <View style={{height:15,alignItems: 'center'}}/>
                  <View  style={{height:55,alignItems: 'center',backgroundColor:'white'}}>
                      <View style={{height:54,alignItems: 'center',flexDirection: 'row',backgroundColor:'white'}}>
                          <Text style={styles.title_content}>开户行</Text>
                          <TextInput
                            style={styles.name_input}
                            placeholder='请输入开户行'
                            numberOfLines={1}
                            autoFocus={false}
                            textAlign='right'
                            underlineColorAndroid={'transparent'}
                            onChangeText={(text) => {
                                bankname = text;
                            }}
                          />
                    </View>
                    <View style={{height:1,backgroundColor:'white'}}>
                          <View style={{height:1,backgroundColor:'#f4f4f4',marginLeft:10,width:Common.window.width-10}}/>
                    </View>
                  </View>

                  <View  style={{height:55,alignItems: 'center',backgroundColor:'white'}}>
                      <View style={{height:54,alignItems: 'center',flexDirection: 'row',backgroundColor:'white'}}>
                          <Text style={styles.title_content}>银行卡号</Text>
                          <TextInput
                            style={styles.name_input}
                            placeholder='请输入银行卡号'
                            numberOfLines={1}
                            autoFocus={false}
                            textAlign='right'
                            underlineColorAndroid={'transparent'}
                            onChangeText={(text) => {
                                bankcard = text;
                            }}
                          />
                    </View>
                    <View style={{height:1,backgroundColor:'white'}}>
                          <View style={{height:1,backgroundColor:'#f4f4f4',marginLeft:10,width:Common.window.width-10}}/>
                    </View>
                  </View>
              </ScrollView>
          </View>
      );
    }
    onPressHandler = () => {
        InteractionManager.runAfterInteractions(() => {
            if (bankname == undefined) {
              toastShort('请输入开户行');
            } else if (bankcard ==undefined) {
              toastShort('请输入银行卡号');
            } else {
              this.request();
            }
        });
    }
    request() {
        var modifyuserinfo = REQUEST_JSON.modifyuserinfo;
        modifyuserinfo.userid = '123';
        let cards = {bank_card_num: bankcard, bank: bankname}
        modifyuserinfo.bank_cards = [cards];
        repository.launchRequest('modifyuserinfo',modifyuserinfo).then((responseData) => {
            alert(responseData.retinfo.retmsg)
            this.props.info==0?this.props.navigator.popToTop():this.props.navigator.pop()
        }).done();
    }
}

const styles = StyleSheet.create({
    title_promte:{
      marginTop:20,
      height:20,
      textAlign: 'center',
      fontSize: 13,
      color: '#999999',
    },
    title_content:{
      marginLeft:10,
      height:20,
      marginTop:8,
      width:90,
      textAlign: 'left',
      fontSize: 14,
      color: '#333333',
    },
    name_input:{
      marginLeft:10,
      marginTop:5,
      marginRight:10,
      fontSize:14,
      width:Common.window.width-120,
      height:45,
      color:'#666666'
    },
    rowCell_style:{
      height:55,
      alignItems: 'center',
      flexDirection: 'row',
      backgroundColor:'white',
      borderBottomColor: '#f4f4f4',
      borderBottomWidth: 1,
    },
    RowImage_right: {
     height: 8,
     width: 15,
     marginRight: 10,
     marginLeft:5
    },
    content_text:{
      marginLeft:10,
      height:20,
      marginTop:8,
      width:Common.window.width-90-30-18,
      textAlign:'right',
      fontSize:14,
      marginRight:8,
      color:'#666666'
    },
    center:{
       flexDirection: 'row',
       justifyContent: 'center',
       alignItems: 'center',
    },
});

module.exports = AddBankCardContainer;
